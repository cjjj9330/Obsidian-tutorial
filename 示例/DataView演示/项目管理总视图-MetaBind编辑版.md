---
cssclasses:
  - dataview
ÊÄª‰ªªÂä°Êï∞: 8
ÂΩìÂâçÂÆåÊàêÊï∞: 4
ÂÆåÊàêÂ∫¶: 50%
obsidianUIMode: preview
savedFilters: '[{"column":"assignee","columnName":"Ë¥üË¥£‰∫∫","condition":"notEquals","value":"Âº†‰∏â"}]'
savedSort: '{"column":"priority","ascending":false}'

---
## üéØ È°πÁõÆÊ¶ÇËßà - Meta Bind ÂèØÁºñËæëÁâàÊú¨

> üöÄ **Êñ∞ÂäüËÉΩ**ÔºöËøô‰∏™ÁâàÊú¨‰ΩøÁî® Meta Bind Êèí‰ª∂ÂÆûÁé∞Ë°®Ê†ºÂÜÖÁõ¥Êé•ÁºñËæëÔºÅÁÇπÂáªË°®Ê†º‰∏≠ÁöÑÂ≠óÊÆµÂç≥ÂèØ‰øÆÊîπÔºåÊõ¥Êîπ‰ºöËá™Âä®‰øùÂ≠òÂà∞ÂØπÂ∫îÁöÑ‰ªªÂä°Êñá‰ª∂‰∏≠„ÄÇ

```dataviewjs
// ÂàõÂª∫Êï∞ÊçÆÂ∫ìËßÜÂõæ - Meta Bind Â¢ûÂº∫Áâà
const pages = dv.pages('"Á§∫‰æã/DataViewÊºîÁ§∫/‰ªªÂä°Êï∞ÊçÆ"').sort(p => p.file.name, 'asc');

const savedFilters = dv.current().savedFilters ? JSON.parse(dv.current().savedFilters) : []; 
const savedSort = dv.current().savedSort ? JSON.parse(dv.current().savedSort) : {column: "priority", ascending: false};

console.log("È°µÈù¢ÊÄªÊï∞:", pages.length);
console.log("È°µÈù¢‰∏≠ÁöÑStatusÂÄºÁ§∫‰æã:", pages.slice(0, 3).map(p => ({ÂêçÁß∞: p.file.name, Áä∂ÊÄÅ: p.status})));

// ËÆ°ÁÆó‰ªªÂä°ÁªüËÆ°Êï∞ÊçÆ
const totalTasks = pages.length;
const completedTasks = pages.filter(p => {
    const status = (p.status || "").toString().trim();
    return status === "Â∑≤ÂÆåÊàê";
}).length;

const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;

// Ëé∑ÂèñÂΩìÂâçÊñá‰ª∂ÁöÑÂ±ûÊÄßÂÄº
const currentFile = dv.current().file;
const currentTotal = dv.current().ÊÄª‰ªªÂä°Êï∞;
const currentCompleted = dv.current().ÂΩìÂâçÂÆåÊàêÊï∞;
const currentRate = dv.current().ÂÆåÊàêÂ∫¶;

console.log("ÊØîËæÉ: ÂΩìÂâçÂÄº vs Êñ∞ÂÄº", {
    ÊÄª‰ªªÂä°Êï∞: [currentTotal, totalTasks],
    ÂΩìÂâçÂÆåÊàêÊï∞: [currentCompleted, completedTasks],
    ÂÆåÊàêÁéá: [currentRate, `${completionRate}%`]
});

const isTotalChanged = Number(currentTotal) !== Number(totalTasks);
const isCompletedChanged = Number(currentCompleted) !== Number(completedTasks);
const isRateChanged = currentRate !== `${completionRate}%`;

try {
    if (app.plugins.plugins["metaedit"]) {
        const { update } = app.plugins.plugins["metaedit"].api;
        
        let needsUpdate = false;
        
        if (isTotalChanged) {
            update("ÊÄª‰ªªÂä°Êï∞", totalTasks, currentFile.path);
            needsUpdate = true;
        }
        
        if (isCompletedChanged) {
            update("ÂΩìÂâçÂÆåÊàêÊï∞", completedTasks, currentFile.path);
            needsUpdate = true;
        }
        
        const newRate = `${completionRate}%`;
        if (isRateChanged) {
            update("ÂÆåÊàêÂ∫¶", newRate, currentFile.path);
            needsUpdate = true;
        }
        
        if (needsUpdate) {
            console.log("Â±ûÊÄßÂ∑≤ÈÄöËøáMetaEditÊõ¥Êñ∞");
        }
    } else {
        if (isTotalChanged) dv.current().ÊÄª‰ªªÂä°Êï∞ = totalTasks;
        if (isCompletedChanged) dv.current().ÂΩìÂâçÂÆåÊàêÊï∞ = completedTasks;
        if (isRateChanged) dv.current().ÂÆåÊàêÂ∫¶ = `${completionRate}%`;
        
        console.log("MetaEditÊèí‰ª∂Êú™ÂÆâË£ÖÔºå‰ΩøÁî®Â§áÁî®ÊñπÊ≥ïÊõ¥Êñ∞Â±ûÊÄß");
    }
} catch (error) {
    console.error("Êõ¥Êñ∞Â±ûÊÄßÊó∂Âá∫Èîô:", error);
    if (isTotalChanged) dv.current().ÊÄª‰ªªÂä°Êï∞ = totalTasks;
    if (isCompletedChanged) dv.current().ÂΩìÂâçÂÆåÊàêÊï∞ = completedTasks;
    if (isRateChanged) dv.current().ÂÆåÊàêÂ∫¶ = `${completionRate}%`;
}

// È¢ÑÂÆö‰πâÈÄâÈ°π
const predefinedOptions = {
    "status": ["Êú™ÂºÄÂßã", "ËøõË°å‰∏≠", "Â∑≤ÂÆåÊàê", "Â∑≤ÊöÇÂÅú"],
    "priority": ["È´ò", "‰∏≠", "‰Ωé"],
    "category": ["ÂâçÁ´ØÂºÄÂèë", "ÂêéÁ´ØÂºÄÂèë", "ËÆæËÆ°", "ÊµãËØï", "ÊñáÊ°£", "ËøêÁª¥"],
    "assignee": ["Âº†‰∏â", "ÊùéÂõõ", "Áéã‰∫î", "ËµµÂÖ≠"]
};

// Êï∞ÂÄºÁ±ªÂûãÁöÑÂàó
const numberColumns = ["estimate_hours", "actual_hours", "progress"];

// Meta Bind Â≠óÊÆµÂàõÂª∫ÂáΩÊï∞ - ‰øÆÂ§çÁâàÊú¨
function createMetaBindSelect(filePath, property, currentValue, options) {
    const bindTarget = `${filePath}#${property}`;
    
    // ÂàõÂª∫ÈÄâÈ°πÂ≠óÁ¨¶‰∏≤
    const optionsArray = options.map(opt => `option("${opt}", "${opt}")`);
    const optionsStr = optionsArray.join(', ');
    
    // ËøîÂõûÊ≠£Á°ÆÁöÑMeta BindËØ≠Ê≥ïÔºà‰∏çÁî®ÂèçÂºïÂè∑ÂåÖË£πÔºâ
    return `INPUT[select(${optionsStr}):${bindTarget}]`;
}

function createMetaBindNumber(filePath, property, currentValue) {
    const bindTarget = `${filePath}#${property}`;
    return `INPUT[number:${bindTarget}]`;
}

function createMetaBindSlider(filePath, property, currentValue) {
    const bindTarget = `${filePath}#${property}`;
    return `INPUT[slider(minValue(0), maxValue(100), stepSize(5)):${bindTarget}]`;
}

function createMetaBindDate(filePath, property, currentValue) {
    const bindTarget = `${filePath}#${property}`;
    return `INPUT[date:${bindTarget}]`;
}

function createMetaBindText(filePath, property, currentValue) {
    const bindTarget = `${filePath}#${property}`;
    return `INPUT[text:${bindTarget}]`;
}

// ÂÆö‰πâÂàóËÆæÁΩÆ - Meta Bind Â¢ûÂº∫Áâà
const columns = [
    {
        id: "filename", 
        name: "‰ªªÂä°ÂêçÁß∞", 
        display: p => p.file.link, 
        property: "file.name",
        editable: false
    },
    {
        id: "status", 
        name: "Áä∂ÊÄÅ", 
        display: p => createMetaBindSelect(p.file.path, "status", p.status || "Êú™ÂºÄÂßã", predefinedOptions.status),
        property: "status",
        editable: true
    },
    {
        id: "priority", 
        name: "‰ºòÂÖàÁ∫ß", 
        display: p => createMetaBindSelect(p.file.path, "priority", p.priority || "‰∏≠", predefinedOptions.priority),
        property: "priority",
        editable: true
    },
    {
        id: "category", 
        name: "ÂàÜÁ±ª", 
        display: p => createMetaBindSelect(p.file.path, "category", p.category || "ÂâçÁ´ØÂºÄÂèë", predefinedOptions.category),
        property: "category",
        editable: true
    },
    {
        id: "assignee", 
        name: "Ë¥üË¥£‰∫∫", 
        display: p => createMetaBindSelect(p.file.path, "assignee", p.assignee || "Âº†‰∏â", predefinedOptions.assignee),
        property: "assignee",
        editable: true
    },
    {
        id: "estimate_hours", 
        name: "È¢Ñ‰º∞Â∑•Êó∂", 
        display: p => createMetaBindNumber(p.file.path, "estimate_hours", p.estimate_hours || 0),
        property: "estimate_hours",
        editable: true
    },
    {
        id: "actual_hours", 
        name: "ÂÆûÈôÖÂ∑•Êó∂", 
        display: p => createMetaBindNumber(p.file.path, "actual_hours", p.actual_hours || 0),
        property: "actual_hours",
        editable: true
    },
    {
        id: "progress", 
        name: "ËøõÂ∫¶%", 
        display: p => createMetaBindSlider(p.file.path, "progress", p.progress || 0),
        property: "progress",
        editable: true
    },
    {
        id: "due_date", 
        name: "Êà™Ê≠¢Êó•Êúü", 
        display: p => createMetaBindDate(p.file.path, "due_date", p.due_date || ""),
        property: "due_date",
        editable: true
    },
    {
        id: "created", 
        name: "ÂàõÂª∫Êó•Êúü", 
        display: p => p.file.cday, 
        property: "file.cday",
        editable: false
    }
];

// ÂàõÂª∫Á≠õÈÄâÊéß‰ª∂
const container = this.container;

// Ê∑ªÂä†CSSÊ†∑Âºè
const style = document.createElement('style');
style.textContent = `
.demo-db-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    border-bottom: 2px solid var(--interactive-accent);
    padding-bottom: 10px;
}
.demo-db-title {
    font-size: 1.8em;
    font-weight: bold;
    color: var(--interactive-accent);
}
.demo-db-controls {
    display: flex;
    gap: 8px;
    position: sticky;
    top: 0;
    z-index: 10;
    background-color: var(--background-primary);
    padding: 5px 0;
}
.demo-dropdown {
    position: relative;
    display: inline-block;
}
.demo-dropdown-content {
    display: none;
    position: absolute;
    background-color: var(--background-primary);
    min-width: 200px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    padding: 8px 0;
    z-index: 1;
    border-radius: 4px;
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid var(--background-modifier-border);
}
.demo-applied-filters {
    display: flex;
    flex-wrap: wrap;
    margin-bottom: 10px;
    padding: 8px;
    background-color: rgba(var(--interactive-accent-rgb), 0.1);
    border-radius: 4px;
    min-height: 30px;
}
.demo-filter-pill {
    display: inline-flex;
    align-items: center;
    background-color: var(--interactive-accent);
    color: var(--text-on-accent);
    border-radius: 16px;
    padding: 4px 10px;
    margin-right: 8px;
    margin-bottom: 4px;
    font-size: 0.9em;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.demo-dropdown-content.show {
    display: block;
}
.demo-filter-item {
    padding: 8px 12px;
    cursor: pointer;
}
.demo-filter-item:hover {
    background-color: var(--background-secondary);
}
.demo-filter-select {
    padding: 8px 12px;
    border: none;
    width: 100%;
    background-color: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
}
.demo-filter-pill-close {
    margin-left: 6px;
    cursor: pointer;
    font-weight: bold;
}
.demo-db-button {
    background-color: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 8px 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
    font-weight: 500;
    transition: all 0.2s ease;
}
.demo-db-button:hover {
    background-color: var(--interactive-hover);
    transform: translateY(-1px);
}
.demo-sticky-controls-container {
    position: sticky;
    top: 0;
    z-index: 100;
    background-color: var(--background-primary);
    padding: 10px 0;
    margin-bottom: 10px;
    border-bottom: 1px solid var(--background-modifier-border);
}
.demo-table-count-info {
    margin-top: 10px; 
    padding: 12px; 
    background-color: var(--background-secondary); 
    border-radius: 6px; 
    text-align: center;
    font-weight: bold;
    border-left: 4px solid var(--interactive-accent);
}
.demo-no-results-message {
    padding: 40px 20px;
    text-align: center;
    background-color: var(--background-secondary);
    border-radius: 8px;
    margin: 20px 0;
}
.metabind-info-box {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    text-align: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
.metabind-demo-table {
    background-color: var(--background-secondary);
    border-radius: 8px;
    padding: 10px;
    margin: 10px 0;
}
/* Meta Bind Â≠óÊÆµÊ†∑Âºè‰ºòÂåñ */
.meta-bind-input {
    min-width: 120px;
    font-size: 0.9em;
}
.meta-bind-slider {
    width: 100px;
}
`;
container.appendChild(style);

// Ê∑ªÂä† Meta Bind ‰ø°ÊÅØÊèêÁ§∫
const metaBindInfo = container.createEl("div", {cls: "metabind-info-box"});
metaBindInfo.innerHTML = `
    <h3>üé® Meta Bind Ë°®Ê†ºÁºñËæëÊºîÁ§∫</h3>
    <p>‚ú® ‰∏ãÊñπË°®Ê†º‰∏≠ÁöÑÂ≠óÊÆµÈÉΩÂèØ‰ª•Áõ¥Êé•ÁºñËæëÔºÅ‰øÆÊîπÂêé‰ºöËá™Âä®‰øùÂ≠òÂà∞ÂØπÂ∫îÁöÑ‰ªªÂä°Êñá‰ª∂‰∏≠</p>
    <p>üîÑ ÊîØÊåÅÔºö‰∏ãÊãâÈÄâÊã©„ÄÅÊï∞Â≠óËæìÂÖ•„ÄÅÊªëÂùóË∞ÉËäÇ„ÄÅÊó•ÊúüÈÄâÊã©Á≠âÂ§öÁßçËæìÂÖ•ÊñπÂºè</p>
`;

// ÂàõÂª∫Êï∞ÊçÆÂ∫ìÊ†áÈ¢òÂíåÊéß‰ª∂Âå∫Âüü
const headerDiv = container.createEl("div", {cls: "demo-db-header"});
headerDiv.createEl("div", {cls: "demo-db-title", text: "üìã ‰ªªÂä°ÁÆ°ÁêÜÈù¢Êùø - Meta Bind ÂèØÁºñËæëÁâà"});

// ÂàõÂª∫Âõ∫ÂÆöÂú®È°∂ÈÉ®ÁöÑÂÆπÂô®
const stickyContainer = container.createEl("div", {cls: "demo-sticky-controls-container"});
const controlsDiv = stickyContainer.createEl("div", {cls: "demo-db-controls"});

// ÂàõÂª∫Ê∏ÖÈô§ÊåâÈíÆ
const clearButton = controlsDiv.createEl("button", {cls: "demo-db-button"});
clearButton.innerHTML = `<span>üóëÔ∏è Ê∏ÖÈô§Á≠õÈÄâ</span>`;
clearButton.addEventListener("click", () => {
    currentFilters = [];
    renderFilterPills();
    renderTable();
    saveUserSettings();
});

// ÂàõÂª∫ÊéíÂ∫èÊåâÈíÆ
const sortDropdown = controlsDiv.createEl("div", {cls: "demo-dropdown"});
const sortButton = sortDropdown.createEl("button", {cls: "demo-db-button"});
sortButton.innerHTML = `<span>üìä ÊéíÂ∫è</span>`;
const sortContent = sortDropdown.createEl("div", {cls: "demo-dropdown-content"});

// ÂàõÂª∫Á≠õÈÄâÊåâÈíÆ
const filterDropdown = controlsDiv.createEl("div", {cls: "demo-dropdown"});
const filterButton = filterDropdown.createEl("button", {cls: "demo-db-button"});
filterButton.innerHTML = `<span>üîç Á≠õÈÄâ</span>`;
const filterContent = filterDropdown.createEl("div", {cls: "demo-dropdown-content"});

// Ê∑ªÂä†Âà∑Êñ∞ÊåâÈíÆ
const refreshButton = controlsDiv.createEl("button", {cls: "demo-db-button"});
refreshButton.innerHTML = `<span>üîÑ Âà∑Êñ∞Ë°®Ê†º</span>`;
refreshButton.addEventListener("click", () => {
    console.log("ÊâãÂä®Âà∑Êñ∞Ë°®Ê†º");
    location.reload(); // ÈáçÊñ∞Âä†ËΩΩÈ°µÈù¢‰ª•Âà∑Êñ∞ Meta Bind Â≠óÊÆµ
});

// ÂΩìÂâçÁ≠õÈÄâÂíåÊéíÂ∫èÁä∂ÊÄÅ
let currentFilters = [];
if (savedFilters && savedFilters.length > 0) {
    currentFilters = JSON.parse(JSON.stringify(savedFilters));
} else {
    currentFilters = [];
}

let currentSort = savedSort || {
    column: "priority",
    ascending: false
};

// Ê∑ªÂä†ÊéíÂ∫èÈÄâÈ°π
columns.forEach(column => {
    const sortItem = sortContent.createEl("div", {cls: "demo-filter-item"});
    sortItem.textContent = column.name + " ‚Üë";
    sortItem.addEventListener("click", () => {
        currentSort = {
            column: column.id,
            ascending: true
        };
        updateSortButtonText();
        renderTable();
        saveUserSettings();
        sortContent.classList.remove("show");
    });
    
    const sortItemDesc = sortContent.createEl("div", {cls: "demo-filter-item"});
    sortItemDesc.textContent = column.name + " ‚Üì";
    sortItemDesc.addEventListener("click", () => {
        currentSort = {
            column: column.id,
            ascending: false
        };
        updateSortButtonText();
        renderTable();
        saveUserSettings();
        sortContent.classList.remove("show");
    });
});

// Ê∑ªÂä†Á≠õÈÄâÂ≠óÊÆµÈÄâÈ°π
columns.forEach(column => {
    const filterItem = filterContent.createEl("div", {cls: "demo-filter-item"});
    filterItem.textContent = column.name;
    filterItem.addEventListener("click", () => {
        showFilterOptionsForColumn(column);
        filterContent.classList.remove("show");
    });
});

// ÊòæÁ§∫ÂàóÁ≠õÈÄâÈÄâÈ°π
function showFilterOptionsForColumn(column) {
    const modal = document.createElement("div");
    modal.style.cssText = `
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background-color: rgba(0, 0, 0, 0.5); display: flex;
        justify-content: center; align-items: center; z-index: 1000;
    `;
    
    const dialog = document.createElement("div");
    dialog.style.cssText = `
        background-color: var(--background-primary); padding: 20px;
        border-radius: 8px; width: 350px; max-height: 80%; overflow-y: auto;
        border: 1px solid var(--background-modifier-border);
    `;
    
    const header = document.createElement("div");
    header.style.cssText = "display: flex; justify-content: space-between; margin-bottom: 15px;";
    
    const title = document.createElement("h3");
    title.textContent = `Á≠õÈÄâ: ${column.name}`;
    title.style.margin = "0";
    
    const closeBtn = document.createElement("button");
    closeBtn.textContent = "√ó";
    closeBtn.style.cssText = `
        background: none; border: none; font-size: 1.5em; cursor: pointer;
        color: var(--text-muted);
    `;
    closeBtn.onclick = () => document.body.removeChild(modal);
    
    header.appendChild(title);
    header.appendChild(closeBtn);
    dialog.appendChild(header);
    
    // Ëé∑ÂèñËØ•ÂàóÊâÄÊúâÂèØËÉΩÁöÑÂÄº
    let values = [];
    
    if (predefinedOptions[column.property]) {
        const existingValues = getExistingValues(column.property);
        values = [...new Set([...predefinedOptions[column.property], ...existingValues])];
    } else {
        values = getExistingValues(column.property);
    }
    
    function getExistingValues(property) {
        try {
            const valueSet = new Set();
            
            pages.forEach(p => {
                try {
                    let value;
                    if (property.startsWith("file.")) {
                        const propPath = property.split(".");
                        value = p;
                        for (const prop of propPath) {
                            value = value[prop];
                        }
                    } else {
                        value = p[property];
                    }
                    
                    if (Array.isArray(value)) {
                        value.forEach(v => {
                            if (v !== null && v !== undefined && v !== "") {
                                valueSet.add(String(v));
                            }
                        });
                    } else if (value !== null && value !== undefined && value !== "") {
                        valueSet.add(String(value));
                    }
                } catch (e) {}
            });
            
            return Array.from(valueSet).sort();
        } catch (e) {
            console.error("Ëé∑ÂèñÂàóÂÄºÈîôËØØ:", e);
            return [];
        }
    }
    
    // ÂàõÂª∫ÈÄâÈ°π
    const select = document.createElement("select");
    select.className = "demo-filter-select";
    select.style.cssText = "width: 100%; margin-bottom: 15px; padding: 8px; border-radius: 4px;";
    
    const defaultOption = document.createElement("option");
    defaultOption.value = "";
    defaultOption.textContent = "ÈÄâÊã©Á≠õÈÄâÊù°‰ª∂...";
    select.appendChild(defaultOption);
    
    ["equals", "notEquals", "contains"].forEach(condition => {
        const option = document.createElement("option");
        option.value = condition;
        option.textContent = {
            "equals": "Á≠â‰∫é",
            "notEquals": "‰∏çÁ≠â‰∫é", 
            "contains": "ÂåÖÂê´"
        }[condition];
        select.appendChild(option);
    });
    
    if (numberColumns.includes(column.property)) {
        ["greater", "less"].forEach(condition => {
            const option = document.createElement("option");
            option.value = condition;
            option.textContent = condition === "greater" ? "Â§ß‰∫é" : "Â∞è‰∫é";
            select.appendChild(option);
        });
    }
    
    dialog.appendChild(select);
    
    // ÂÄºËæìÂÖ•Âå∫Âüü
    const inputArea = document.createElement("div");
    
    const valueSelect = document.createElement("select");
    valueSelect.style.cssText = "width: 100%; padding: 8px; margin-bottom: 15px; display: none; border-radius: 4px;";
    
    const emptyOption = document.createElement("option");
    emptyOption.value = "";
    emptyOption.textContent = "ÈÄâÊã©‰∏Ä‰∏™ÂÄº...";
    valueSelect.appendChild(emptyOption);
    
    if (Array.isArray(values)) {
        values.sort().forEach(value => {
            if (value !== null && value !== undefined && value !== "") {
                const option = document.createElement("option");
                option.value = String(value);
                option.textContent = String(value);
                valueSelect.appendChild(option);
            }
        });
    }
    
    const valueInput = document.createElement("input");
    valueInput.type = "text";
    valueInput.style.cssText = "width: 100%; padding: 8px; margin-bottom: 15px; display: none; border-radius: 4px;";
    valueInput.placeholder = "ËæìÂÖ•Á≠õÈÄâÂÄº...";
    
    const numberInput = document.createElement("input");
    numberInput.type = "number";
    numberInput.style.cssText = "width: 100%; padding: 8px; margin-bottom: 15px; display: none; border-radius: 4px;";
    numberInput.placeholder = "ËæìÂÖ•Êï∞Â≠ó...";
    
    inputArea.appendChild(valueSelect);
    inputArea.appendChild(valueInput);
    inputArea.appendChild(numberInput);
    dialog.appendChild(inputArea);
    
    select.onchange = () => {
        valueSelect.style.display = "none";
        valueInput.style.display = "none";
        numberInput.style.display = "none";
        
        const selectedOption = select.value;
        if (!selectedOption) return;
        
        if (numberColumns.includes(column.property) && ["greater", "less"].includes(selectedOption)) {
            numberInput.style.display = "block";
        } else if (values.length > 0 && ["equals", "notEquals", "contains"].includes(selectedOption)) {
            valueSelect.style.display = "block";
        } else {
            valueInput.style.display = "block";
        }
    };
    
    // Ê∑ªÂä†ÊåâÈíÆ
    const buttonContainer = document.createElement("div");
    buttonContainer.style.cssText = "display: flex; justify-content: flex-end; gap: 10px;";
    
    const cancelBtn = document.createElement("button");
    cancelBtn.textContent = "ÂèñÊ∂à";
    cancelBtn.className = "demo-db-button";
    cancelBtn.onclick = () => document.body.removeChild(modal);
    
    const applyBtn = document.createElement("button");
    applyBtn.textContent = "Â∫îÁî®";
    applyBtn.className = "demo-db-button";
    applyBtn.style.cssText = "background-color: var(--interactive-accent); color: var(--text-on-accent);";
    
    applyBtn.onclick = () => {
        const condition = select.value;
        let value = '';
        
        if (numberColumns.includes(column.property) && ["greater", "less"].includes(condition)) {
            value = numberInput.value.trim();
        } else if (valueSelect.style.display === "block") {
            value = valueSelect.value.trim();
        } else {
            value = valueInput.value.trim();
        }
        
        if (condition) {
            if (!value) {
                if (predefinedOptions[column.property] && predefinedOptions[column.property].length > 0) {
                    value = predefinedOptions[column.property][0];
                } else {
                    alert("ËØ∑ËæìÂÖ•Á≠õÈÄâÂÄº");
                    return;
                }
            }
            
            const existingFilterIndex = currentFilters.findIndex(f => f.column === column.id);
            
            if (existingFilterIndex >= 0) {
                currentFilters[existingFilterIndex] = {
                    column: column.id,
                    columnName: column.name,
                    condition,
                    value
                };
            } else {
                currentFilters.push({
                    column: column.id,
                    columnName: column.name,
                    condition,
                    value
                });
            }
            
            saveUserSettings();
            renderFilterPills();
            renderTable();
            document.body.removeChild(modal);
        } else {
            alert("ËØ∑ÈÄâÊã©Á≠õÈÄâÊù°‰ª∂");
        }
    };
    
    buttonContainer.appendChild(cancelBtn);
    buttonContainer.appendChild(applyBtn);
    dialog.appendChild(buttonContainer);
    
    modal.appendChild(dialog);
    document.body.appendChild(modal);
}

// Â∫îÁî®Á≠õÈÄâÊù°‰ª∂ËøáÊª§È°µÈù¢
function filterPages(pages) {
    if (currentFilters.length === 0) return pages;
    
    return pages.filter(page => {
        return currentFilters.every(filter => {
            const column = columns.find(c => c.id === filter.column);
            if (!column) return true;
            
            let pageValue;
            try {
                if (column.property.startsWith("file.")) {
                    const propPath = column.property.split(".");
                    let value = page;
                    for (const prop of propPath) {
                        value = value[prop];
                    }
                    pageValue = value;
                } else {
                    pageValue = page[column.property];
                }
            } catch (e) {
                return false;
            }
            
            if (pageValue === undefined || pageValue === null) {
                if (filter.condition === "notEquals") {
                    return filter.value !== "";
                }
                return false;
            }
            
            const stringValue = String(pageValue).toLowerCase();
            const filterValue = filter.value.toLowerCase();
            
            switch (filter.condition) {
                case "equals":
                    return stringValue === filterValue;
                case "notEquals":
                    return stringValue !== filterValue;
                case "contains":
                    return stringValue.includes(filterValue);
                case "greater":
                    return parseFloat(pageValue) > parseFloat(filter.value);
                case "less":
                    return parseFloat(pageValue) < parseFloat(filter.value);
                default:
                    return true;
            }
        });
    });
}

// Ê∏≤ÊüìÁ≠õÈÄâÊù°‰ª∂Pills
function renderFilterPills() {
    const existingPills = container.querySelector(".demo-applied-filters");
    if (existingPills) {
        existingPills.remove();
    }
    
    const pillsContainer = stickyContainer.createEl("div", {cls: "demo-applied-filters"});
    
    if (currentFilters.length === 0) {
        pillsContainer.createEl("div", {
            cls: "filter-info",
            text: "üí° ÁÇπÂáª‰∏äÊñπÁöÑÁ≠õÈÄâÊåâÈíÆÊ∑ªÂä†Á≠õÈÄâÊù°‰ª∂",
            attr: {style: "color: var(--text-muted); font-style: italic;"}
        });
        return;
    }
    
    const filterLabel = pillsContainer.createEl("div", {
        cls: "filter-label",
        text: "üîç ÂΩìÂâçÁ≠õÈÄâ: ",
        attr: {style: "margin-right: 10px; font-weight: bold;"}
    });
    
    currentFilters.forEach((filter, index) => {
        const pill = pillsContainer.createEl("div", {cls: "demo-filter-pill"});
        
        let conditionText;
        switch (filter.condition) {
            case "equals": conditionText = "Á≠â‰∫é"; break;
            case "notEquals": conditionText = "‰∏çÁ≠â‰∫é"; break;
            case "contains": conditionText = "ÂåÖÂê´"; break;
            case "greater": conditionText = "Â§ß‰∫é"; break;
            case "less": conditionText = "Â∞è‰∫é"; break;
            default: conditionText = filter.condition;
        }
        
        pill.textContent = `${filter.columnName} ${conditionText} ${filter.value}`;
        
        const closeBtn = pill.createEl("span", {cls: "demo-filter-pill-close", text: "√ó"});
        closeBtn.addEventListener("click", () => {
            currentFilters.splice(index, 1);
            renderFilterPills();
            renderTable();
            saveUserSettings();
        });
    });
}

// Êõ¥Êñ∞ÊéíÂ∫èÊåâÈíÆÊñáÊú¨
function updateSortButtonText() {
    const column = columns.find(c => c.id === currentSort.column);
    if (column) {
        sortButton.innerHTML = `<span>üìä ÊéíÂ∫è: ${column.name} ${currentSort.ascending ? '‚Üë' : '‚Üì'}</span>`;
    }
}

// ÂÆâÂÖ®ÁöÑÊéíÂ∫èÂáΩÊï∞
function safeSort(pages, sortFunc) {
    try {
        return pages.sort(sortFunc);
    } catch (error) {
        console.error("ÊéíÂ∫èÈîôËØØ:", error);
        return pages.sort((a, b) => a.file.name.localeCompare(b.file.name));
    }
}

// Ê∏≤ÊüìË°®Ê†ºÂáΩÊï∞ - Meta Bind Â¢ûÂº∫Áâà
function renderTable() {
    const existingTable = container.querySelector("table");
    if (existingTable) {
        existingTable.remove();
    }
    
    const noResultsMessage = container.querySelector(".demo-no-results-message");
    if (noResultsMessage) {
        noResultsMessage.remove();
    }
    
    const existingCountInfo = container.querySelector(".demo-table-count-info");
    if (existingCountInfo) {
        existingCountInfo.remove();
    }
    
    // Â∫îÁî®Á≠õÈÄâ
    let filteredPages = pages;
    
    if (currentFilters.length > 0) {
        filteredPages = filterPages(filteredPages);
    }
    
    // Â¶ÇÊûúÊ≤°ÊúâÂåπÈÖçÁªìÊûú
    if (filteredPages.length === 0 && currentFilters.length > 0) {
        const messageDiv = container.createEl("div", {
            cls: "demo-no-results-message"
        });
        
        messageDiv.innerHTML = `
            <h3>üòÖ Ê≤°ÊúâÊâæÂà∞ÂåπÈÖçÁöÑ‰ªªÂä°</h3>
            <p>ËØ∑Â∞ùËØïË∞ÉÊï¥Á≠õÈÄâÊù°‰ª∂ÊàñÊ∏ÖÈô§ÊâÄÊúâÁ≠õÈÄâ</p>
            <button class="demo-db-button clear-filters-btn" style="margin: 10px auto; display: block; background-color: var(--interactive-accent); color: var(--text-on-accent);">
                üóëÔ∏è Ê∏ÖÈô§ÊâÄÊúâÁ≠õÈÄâÊù°‰ª∂
            </button>
        `;
        
        messageDiv.querySelector(".clear-filters-btn").addEventListener("click", () => {
            currentFilters = [];
            renderFilterPills();
            renderTable();
            saveUserSettings();
        });
        
        try {
            dv.table(
                columns.map(col => col.name),
                []
            );
            
            const countInfo = container.createEl("div", {
                cls: "demo-table-count-info"
            });
            countInfo.innerHTML = `<span>üìä ÊòæÁ§∫‰ªªÂä°: 0 / ${totalTasks}</span>`;
        } catch (error) {
            console.error("Ë°®Ê†ºÊ∏≤ÊüìÈîôËØØ:", error);
        }
        
        return;
    }
    
    // Â∫îÁî®ÊéíÂ∫è
    const sortFunc = getSortFunction(currentSort.column);
    const sortedPages = currentSort.ascending ? 
        safeSort([...filteredPages], sortFunc) : 
        safeSort([...filteredPages], sortFunc).reverse();
    
    try {
        // ÂàõÂª∫Ë°®Ê†º - ‰ΩøÁî® Meta Bind Â≠óÊÆµ
        dv.table(
            columns.map(col => col.name), 
            sortedPages.map(p => columns.map(col => {
                try {
                    return col.display(p);
                } catch (error) {
                    console.error(`ÊòæÁ§∫ÈîôËØØ (${col.id}):`, error);
                    return "-";
                }
            }))
        );
        
        // Ê∑ªÂä†ËÆ°Êï∞ÂäüËÉΩ
        const countInfo = container.createEl("div", {
            cls: "demo-table-count-info"
        });
        
        countInfo.innerHTML = `<span>üìä ÊòæÁ§∫‰ªªÂä°: ${sortedPages.length} / ${totalTasks} | üéØ Â∑≤ÂÆåÊàê: ${completedTasks} (${completionRate}%) | ‚ú® Meta Bind ÂèØÁºñËæëÊ®°Âºè</span>`;
    } catch (error) {
        console.error("Ë°®Ê†ºÊ∏≤ÊüìÈîôËØØ:", error);
        const errorDiv = container.createEl("div");
        errorDiv.innerHTML = `<p style="color: red">‚ö†Ô∏è Ë°®Ê†ºÊ∏≤ÊüìÂá∫Èîô: ${error.message}</p>`;
    }
}

// Ëé∑ÂèñÊéíÂ∫èÂáΩÊï∞
function getSortFunction(columnId) {
    switch(columnId) {
        case "filename":
            return (a, b) => (a?.file?.name || "").localeCompare(b?.file?.name || "");
        case "created":
            return (a, b) => (a?.file?.cday || 0) - (b?.file?.cday || 0);
        case "priority":
            return (a, b) => {
                const priorityOrder = {"È´ò": 3, "‰∏≠": 2, "‰Ωé": 1};
                const aVal = priorityOrder[a.priority] || 0;
                const bVal = priorityOrder[b.priority] || 0;
                return aVal - bVal;
            };
        default:
            const column = columns.find(c => c.id === columnId);
            if (!column) return (a, b) => 0;
            
            const property = column.property;
            
            if (numberColumns.includes(property) || ["estimate_hours", "actual_hours", "progress"].includes(columnId)) {
                return (a, b) => {
                    let aVal, bVal;
                    try {
                        if (property.startsWith("file.")) {
                            const propPath = property.split(".");
                            let valueA = a;
                            let valueB = b;
                            for (const prop of propPath) {
                                valueA = valueA?.[prop];
                                valueB = valueB?.[prop];
                            }
                            aVal = parseFloat(valueA) || 0;
                            bVal = parseFloat(valueB) || 0;
                        } else {
                            aVal = parseFloat((a?.[property] || "0").toString().replace("%", "")) || 0;
                            bVal = parseFloat((b?.[property] || "0").toString().replace("%", "")) || 0;
                        }
                    } catch (e) {
                        aVal = 0;
                        bVal = 0;
                    }
                    return aVal - bVal;
                };
            } else {
                return (a, b) => {
                    let aVal, bVal;
                    try {
                        if (property.startsWith("file.")) {
                            const propPath = property.split(".");
                            let valueA = a;
                            let valueB = b;
                            for (const prop of propPath) {
                                valueA = valueA?.[prop];
                                valueB = valueB?.[prop];
                            }
                            aVal = String(valueA || "");
                            bVal = String(valueB || "");
                        } else {
                            aVal = String(a?.[property] || "");
                            bVal = String(b?.[property] || "");
                        }
                    } catch (e) {
                        aVal = "";
                        bVal = "";
                    }
                    return aVal.localeCompare(bVal);
                };
            }
    }
}

function saveUserSettings() {
    try {
        if (app.plugins.plugins["metaedit"]) {
            const { update } = app.plugins.plugins["metaedit"].api;
            
            console.log("‰øùÂ≠òÁ≠õÈÄâÊù°‰ª∂:", JSON.stringify(currentFilters));
            
            update("savedFilters", JSON.stringify(currentFilters), currentFile.path);
            update("savedSort", JSON.stringify(currentSort), currentFile.path);
            
            console.log("ËÆæÁΩÆÂ∑≤‰øùÂ≠ò");
        } else {
            console.log("MetaEditÊèí‰ª∂Êú™ÂÆâË£Ö");
            dv.current().savedFilters = JSON.stringify(currentFilters);
            dv.current().savedSort = JSON.stringify(currentSort);
        }
    } catch (error) {
        console.error("‰øùÂ≠òËÆæÁΩÆÂ§±Ë¥•:", error);
    }
}

// ‰∫ã‰ª∂ÁõëÂê¨Âô®
sortButton.addEventListener("click", event => {
    event.stopPropagation();
    sortContent.classList.toggle("show");
    filterContent.classList.remove("show");
});

filterButton.addEventListener("click", event => {
    event.stopPropagation();
    filterContent.classList.toggle("show");
    sortContent.classList.remove("show");
});

document.addEventListener("click", () => {
    sortContent.classList.remove("show");
    filterContent.classList.remove("show");
});

// ÂàùÂßãÊ∏≤Êüì
updateSortButtonText();
renderTable();
renderFilterPills();

console.log("Â∫îÁî®Á≠õÈÄâÊù°‰ª∂:", currentFilters);

setInterval(() => {
    const pillsContainer = container.querySelector(".demo-applied-filters");
    if (!pillsContainer && currentFilters.length > 0) {
        console.log("Ê£ÄÊµãÂà∞Á≠õÈÄâÊù°‰ª∂ÊòæÁ§∫‰∏¢Â§±ÔºåÈáçÊñ∞Ê∏≤Êüì");
        renderFilterPills();
    }
}, 2000);
```

## üìù Meta Bind ÂèØÁºñËæëË°®Ê†º‰ΩøÁî®ËØ¥Êòé

### üé® **Êñ∞Â¢ûÂäüËÉΩ - Ë°®Ê†ºÂÜÖÁõ¥Êé•ÁºñËæë**

1. **Áä∂ÊÄÅÂ≠óÊÆµ** - ‰∏ãÊãâÈÄâÊã©Ê°ÜÔºöÊú™ÂºÄÂßã/ËøõË°å‰∏≠/Â∑≤ÂÆåÊàê/Â∑≤ÊöÇÂÅú
2. **‰ºòÂÖàÁ∫ßÂ≠óÊÆµ** - ‰∏ãÊãâÈÄâÊã©Ê°ÜÔºöÈ´ò/‰∏≠/‰Ωé  
3. **ÂàÜÁ±ªÂ≠óÊÆµ** - ‰∏ãÊãâÈÄâÊã©Ê°ÜÔºöÂâçÁ´ØÂºÄÂèë/ÂêéÁ´ØÂºÄÂèë/ËÆæËÆ°/ÊµãËØï/ÊñáÊ°£/ËøêÁª¥
4. **Ë¥üË¥£‰∫∫Â≠óÊÆµ** - ‰∏ãÊãâÈÄâÊã©Ê°ÜÔºöÂº†‰∏â/ÊùéÂõõ/Áéã‰∫î/ËµµÂÖ≠
5. **È¢Ñ‰º∞Â∑•Êó∂/ÂÆûÈôÖÂ∑•Êó∂** - Êï∞Â≠óËæìÂÖ•Ê°Ü
6. **ËøõÂ∫¶Â≠óÊÆµ** - ÊªëÂùóÊéß‰ª∂ (0-100%)
7. **Êà™Ê≠¢Êó•Êúü** - Êó•ÊúüÈÄâÊã©Âô®

### üîÑ **ÂÆûÊó∂ÂêåÊ≠•Êú∫Âà∂**
- ÊâÄÊúâÁºñËæë‰ºöÁ´ãÂç≥‰øùÂ≠òÂà∞ÂØπÂ∫î‰ªªÂä°Êñá‰ª∂ÁöÑ frontmatter
- DataView ‰ºöËá™Âä®Ê£ÄÊµãÊñá‰ª∂ÂèòÂåñÂπ∂Êõ¥Êñ∞ÊòæÁ§∫
- ÊîØÊåÅÂ§öÁî®Êà∑Âçè‰ΩúÁºñËæë

### üõ†Ô∏è **Meta Bind ËØ≠Ê≥ïÁ§∫‰æã**

Âú®Ë°®Ê†º‰∏≠‰ΩøÁî®ÁöÑ Meta Bind ËØ≠Ê≥ïÔºö
- `INPUT[select():filePath#property]` - ‰∏ãÊãâÈÄâÊã©
- `INPUT[number():filePath#property]` - Êï∞Â≠óËæìÂÖ•  
- `INPUT[slider():filePath#property]` - ÊªëÂùóÊéß‰ª∂
- `INPUT[date():filePath#property]` - Êó•ÊúüÈÄâÊã©

### üéØ **Êìç‰ΩúÊåáÂçó**
1. Áõ¥Êé•ÁÇπÂáªË°®Ê†º‰∏≠ÁöÑ‰ªª‰ΩïÂèØÁºñËæëÂ≠óÊÆµ
2. ‰øÆÊîπÂÄºÂêéÔºåÂèòÊõ¥‰ºöËá™Âä®‰øùÂ≠ò
3. ‰ΩøÁî®"üîÑ Âà∑Êñ∞Ë°®Ê†º"ÊåâÈíÆÈáçÊñ∞Âä†ËΩΩ Meta Bind Â≠óÊÆµ
4. Á≠õÈÄâÂíåÊéíÂ∫èÂäüËÉΩ‰∏éÁºñËæëÂäüËÉΩÂÆåÂÖ®ÂÖºÂÆπ

### ‚ö° **ÊäÄÊúØ‰ºòÂäø**
- **Êó†ÈúÄÊâãÂä®‰øùÂ≠ò** - ÂÆûÊó∂ÂêåÊ≠•Âà∞Êñá‰ª∂
- **Á±ªÂûãÂÆâÂÖ®** - ÊØèÁßçÂ≠óÊÆµÁ±ªÂûãÈÉΩÊúâÈÄÇÂΩìÁöÑËæìÂÖ•Êéß‰ª∂  
- **Êï∞ÊçÆ‰∏ÄËá¥ÊÄß** - Áõ¥Êé•‰øÆÊîπÊ∫êÊñá‰ª∂Ôºå‰øùËØÅÊï∞ÊçÆÂáÜÁ°ÆÊÄß
- **Áî®Êà∑‰ΩìÈ™å** - Á±ª‰ººÁîµÂ≠êË°®Ê†ºÁöÑÁºñËæë‰ΩìÈ™å