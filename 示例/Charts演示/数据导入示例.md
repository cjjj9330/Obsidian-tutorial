# 数据导入示例

本文档展示了如何在 Obsidian Charts 插件中从外部数据源导入数据，包括 CSV 文件和 Dataview 查询。

## 从 CSV 文件导入数据

Charts 插件支持从 CSV 文件导入数据，这对于处理大量数据特别有用。

### 创建 CSV 文件

首先，我们需要创建一个 CSV 文件。以下是一个示例 CSV 文件的内容，保存为 `月度销售数据.csv`：

```
月份,销售额,成本,利润
一月,12000,7000,5000
二月,19000,11000,8000
三月,15000,9000,6000
四月,25000,14000,11000
五月,22000,12500,9500
六月,30000,16000,14000
```

### 使用 CSV 数据创建图表

```chart
type: line
csvFile: 月度销售数据.csv
labelColumn: 月份
dataColumns:
  - 销售额
  - 成本
  - 利润
options:
  title:
    display: true
    text: 月度销售数据分析
  scales:
    y:
      beginAtZero: true
      title:
        display: true
        text: 金额 (元)
```

### CSV 导入代码说明

- `csvFile` - 指定 CSV 文件的路径（相对于当前笔记）
- `labelColumn` - 指定用作标签（X 轴）的列名
- `dataColumns` - 指定要显示的数据列名
- 如果 CSV 文件包含标题行，插件会自动识别列名

## 从 Dataview 查询导入数据

如果你安装了 Dataview 插件，Charts 插件可以直接使用 Dataview 查询的结果创建图表。

### 准备带有 YAML 前置元数据的笔记

假设你有一些笔记，每个笔记包含以下 YAML 前置元数据：

```yaml
---
title: 每日学习记录
date: 2025-06-01
study_hours: 4
exercise_hours: 1
reading_hours: 2
---
```

### 使用 Dataview 查询创建图表

```chart
type: bar
dataviewQuery: "TABLE date, study_hours, exercise_hours, reading_hours FROM \"日常记录\" SORT date ASC"
labelColumn: date
dataColumns:
  - study_hours
  - exercise_hours
  - reading_hours
options:
  title:
    display: true
    text: 每日时间分配
  scales:
    y:
      stacked: true
      beginAtZero: true
      title:
        display: true
        text: 小时
```

### Dataview 查询代码说明

- `dataviewQuery` - 指定 Dataview 查询语句
- `labelColumn` - 指定用作标签的列名
- `dataColumns` - 指定要显示的数据列名
- 查询结果必须是表格形式

## 动态数据更新

Charts 插件会自动监听数据源的变化，当 CSV 文件或 Dataview 查询结果发生变化时，图表会自动更新。

## 高级数据处理

### 数据转换

你可以在导入数据后对其进行转换：

```chart
type: line
csvFile: 月度销售数据.csv
labelColumn: 月份
dataColumns:
  - 销售额
  - 成本
  - 利润
transforms:
  - type: sort
    columnIndex: 0
    ascending: true
  - type: number
    columnIndices: [1, 2, 3]
    operation: divide
    value: 10000
options:
  title:
    display: true
    text: 月度销售数据分析（万元）
```

### 数据转换代码说明

- `transforms` - 定义一系列数据转换操作
- `type: sort` - 对数据进行排序
- `type: number` - 对数字数据进行数学运算
- 其他转换类型包括 `filter`、`map` 等

## 数据过滤示例

你可以使用过滤器只显示符合特定条件的数据：

```chart
type: bar
csvFile: 月度销售数据.csv
labelColumn: 月份
dataColumns:
  - 销售额
  - 利润
filters:
  - columnIndex: 1
    operation: greaterThan
    value: 20000
options:
  title:
    display: true
    text: 高销售额月份分析（>20000元）
```

### 数据过滤代码说明

- `filters` - 定义一系列过滤条件
- `columnIndex` - 指定要过滤的列索引（从 0 开始）
- `operation` - 过滤操作，如 `greaterThan`、`lessThan`、`equals` 等
- `value` - 过滤的阈值

## 数据聚合示例

你可以对数据进行聚合计算，如求和、平均值等：

```chart
type: pie
csvFile: 月度销售数据.csv
aggregate:
  labels:
    - 第一季度
    - 第二季度
  series:
    - title: 销售额
      data:
        - sum: [1, 2, 3]
        - sum: [4, 5, 6]
options:
  title:
    display: true
    text: 季度销售额分布
```

### 数据聚合代码说明

- `aggregate` - 定义数据聚合方式
- `labels` - 聚合后的标签
- `data` - 聚合计算，如 `sum`、`average`、`max`、`min` 等
- 数字表示原始数据的列索引（从 1 开始）
